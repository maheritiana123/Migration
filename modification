-- Trop de valeurs → tronquer aux @colCount premières (sans CTE)
IF @valCount > @colCount
BEGIN
    DECLARE @tmp TABLE (Val NVARCHAR(MAX), rn INT);

    INSERT INTO @tmp (Val, rn)
    SELECT Val, ROW_NUMBER() OVER (ORDER BY Ord)
    FROM @valList;

    DELETE FROM @valList;

    INSERT INTO @valList (Val, Ord)
    SELECT Val, rn
    FROM @tmp
    WHERE rn <= @colCount
    ORDER BY rn;
END