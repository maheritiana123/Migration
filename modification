var meta = GetColumnsMetaCached(tableName);
foreach (var col in columnNames)
{
    if (hasIdentity && col.Equals(identityColumn, StringComparison.OrdinalIgnoreCase)) continue;
    if (!row.ContainsKey(col)) continue;
    if (!meta.TryGetValue(col, out var m)) continue;
    if (m.IsComputed) continue;

    var s = row[col]?.ToString();
    var isNullish = string.IsNullOrWhiteSpace(s) || s.Equals("NULL", StringComparison.OrdinalIgnoreCase);

    if (isNullish && !m.IsNullable)
    {
        if (TryParseSimpleDefault(m.ColumnDefault, out var defVal))
            row[col] = defVal;
        else
            row[col] = GetTypeFallback(m.DataType);
    }
}