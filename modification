SELECT tc.CONSTRAINT_NAME, kcu.COLUMN_NAME
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc
JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu
  ON tc.CONSTRAINT_NAME = kcu.CONSTRAINT_NAME
 AND tc.TABLE_NAME      = kcu.TABLE_NAME
WHERE tc.TABLE_NAME = 'VarEnv'
  AND tc.CONSTRAINT_TYPE IN ('PRIMARY KEY','UNIQUE')
ORDER BY tc.CONSTRAINT_NAME, kcu.ORDINAL_POSITION;


-- Cas unique(VENom)
SELECT COUNT(*) 
FROM VarEnv
WHERE VENom = 'vraimentimprobable';

-- Cas unique(VENom,ADVAR)
SELECT COUNT(*)
FROM VarEnv
WHERE VENom = 'vraimentimprobable'
  AND ADVAR IS NULL;   -- ou = 2055, etc. selon le cas


-- DEBUG (temporaire)
PRINT 'RowIndex=' + CAST(@i AS nvarchar(10)) + ' WHERE=' + @whereClause;