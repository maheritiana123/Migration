CREATE PROCEDURE sp_GetForeignKeyInfo
    @TableName NVARCHAR(128)
AS
BEGIN
    SET NOCOUNT ON;

    SELECT 
        KCU.COLUMN_NAME,
        PK.TABLE_NAME AS REFERENCED_TABLE,
        CASE 
            WHEN C.IS_NULLABLE = 'YES' THEN 1 ELSE 0
        END AS IS_NULLABLE
    FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC
    INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU
        ON KCU.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS TC
        ON TC.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS PK
        ON PK.CONSTRAINT_NAME = RC.UNIQUE_CONSTRAINT_NAME
    INNER JOIN INFORMATION_SCHEMA.COLUMNS C
        ON C.TABLE_NAME = KCU.TABLE_NAME
        AND C.COLUMN_NAME = KCU.COLUMN_NAME
    WHERE KCU.TABLE_NAME = @TableName
    ORDER BY KCU.ORDINAL_POSITION;
END
