-- DEBUG: compter les lignes reçues
DECLARE @dbgCount INT = (SELECT COUNT(*) FROM @rows);
PRINT N'[PS DEBUG] rows=' + CAST(@dbgCount AS nvarchar(10))
      + N' len(@ValuesBatch)=' + CAST(LEN(ISNULL(@ValuesBatch,N'')) AS nvarchar(20));

-- Si 0, renvoyer un resultset "debug" (pour que le C# voie au moins 1 ligne)
IF @dbgCount = 0
BEGIN
    SELECT 0 AS RowIndex, NULL AS NewID, N'Batch vide (aucune ligne découpée)' AS ErrorMessage;
    RETURN;
END