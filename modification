private List<string> GetOrderedExtendedRelations()
{
Â  Â  var ordered = new List<string>();
Â  Â  var visited = new HashSet<string>();

Â  Â  void Visit(string table)
Â  Â  {
Â  Â  Â  Â  if (visited.Contains(table)) return;

Â  Â  Â  Â  var fks = GetForeignKeyInfo(table);
Â  Â  Â  Â  foreach (var fk in fks)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  if (_extendedRelations.Contains(fk.ReferencedTableName))
Â  Â  Â  Â  Â  Â  Â  Â  Visit(fk.ReferencedTableName);
Â  Â  Â  Â  }

Â  Â  Â  Â  visited.Add(table);
Â  Â  Â  Â  ordered.Add(table);
Â  Â  }

Â  Â  foreach (var table in _extendedRelations)
Â  Â  {
Â  Â  Â  Â  Visit(table);
Â  Â  }

Â  Â  return ordered;
}

private void ImportExtendedRelationsSafely()
{
Â  Â  var orderedTables = GetOrderedExtendedRelations();
Â  Â  var skipped = new List<string>();
Â  Â  int pass = 1;

Â  Â  foreach (var table in orderedTables)
Â  Â  {
Â  Â  Â  Â  if (_importedTables.Contains(table)) continue;

Â  Â  Â  Â  var fks = GetForeignKeyInfo(table);
Â  Â  Â  Â  bool ready = fks.All(fk => _idMappings.ContainsKey(fk.ReferencedTableName));

Â  Â  Â  Â  if (!ready)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Console.WriteLine($"[ATTENTE] {table} (relation Ã©tendue) : FK manquantes");
Â  Â  Â  Â  Â  Â  skipped.Add(table);
Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  }

Â  Â  Â  Â  Console.WriteLine($"[IMPORT] {table} (relation Ã©tendue)");
Â  Â  Â  Â  ImportExtendedRelationTable(table);
Â  Â  Â  Â  _importedTables.Add(table);
Â  Â  }

Â  Â  if (skipped.Count > 0)
Â  Â  {
Â  Â  Â  Â  if (pass > 5)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Console.WriteLine("ğŸ›‘ Tables de relation Ã©tendues non importables aprÃ¨s plusieurs passes :");
Â  Â  Â  Â  Â  Â  foreach (var t in skipped) Console.WriteLine($" - {t}");
Â  Â  Â  Â  Â  Â  throw new Exception("Import Ã©chouÃ© pour des relations Ã©tendues Ã  cause de dÃ©pendances non rÃ©solues.");
Â  Â  Â  Â  }

Â  Â  Â  Â  pass++;
Â  Â  Â  Â  Console.WriteLine($"ğŸ” Nouvelle passe relations Ã©tendues : {skipped.Count} table(s)");
Â  Â  Â  Â  ImportExtendedRelationsSafely(); // rÃ©cursion contrÃ´lÃ©e
Â  Â  }
}

// 1. Tables parents (avec ordre topologique + passes)
ImportTablesWithFKReadiness(...);

// 2. Relations pures (FK simples)
foreach (var table in _pureRelations)
{
Â  Â  if (_importedTables.Contains(table)) continue;
Â  Â  _importedTables.Add(table);

Â  Â  Console.WriteLine($"Import de la relation pure {table}");
Â  Â  ImportPureRelationTable(table);
}

// 3. Relations Ã©tendues (FK complexes, dÃ©pendances croisÃ©es)
ImportExtendedRelationsSafely();