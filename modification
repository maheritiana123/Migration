DECLARE @ValuesBatch NVARCHAR(MAX);

SET @ValuesBatch = 
      N'improbable_1' + NCHAR(29) + N'2055'
    + NCHAR(30) +
      N'improbable_2' + NCHAR(29) + N'3055';

-- Affiche chaque caractère avec son code hexadécimal
;WITH Numbers AS (
    SELECT TOP (LEN(@ValuesBatch)) ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS n
    FROM sys.all_objects
)
SELECT 
    n AS Position,
    SUBSTRING(@ValuesBatch, n, 1) AS Char,
    CONVERT(VARBINARY(1), SUBSTRING(@ValuesBatch, n, 1)) AS HexValue
FROM Numbers;

-- Appel de la procédure
DECLARE @return_value INT;
EXEC @return_value = [dbo].[batch_safe_insert_with_type_conversion]
    @TableName = N'VarEnv',
    @Columns = N'[VENom],[ADVAR]',
    @ValuesBatch = @ValuesBatch,
    @HasIdentity = 1,
    @IdentityCol = N'VEId';
SELECT 'Return Value' = @return_value;