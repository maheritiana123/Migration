DECLARE @tmp TABLE (NewID nvarchar(100));
INSERT INTO @tmp EXEC sp_executesql @sql;

DECLARE @cnt int = (SELECT COUNT(*) FROM @tmp);
DECLARE @newId nvarchar(100) = (SELECT TOP (1) NewID FROM @tmp);

IF @cnt > 1
BEGIN
    -- On renvoie le 1er ID et on note qu’il y a eu plusieurs rows dans OUTPUT
    INSERT INTO @out(RowIndex, NewID, ErrorMessage)
    VALUES (@i, @newId, N'Note: OUTPUT a retourné ' + CAST(@cnt AS nvarchar(10)) + N' IDs (seulement le 1er conservé)');
END
ELSE
BEGIN
    INSERT INTO @out(RowIndex, NewID, ErrorMessage)
    VALUES (@i, @newId, NULL);
END


SELECT
  RS_Count = LEN(@ValuesBatch) - LEN(REPLACE(@ValuesBatch, NCHAR(30), N'')),
  CS_Count = LEN(@ValuesBatch) - LEN(REPLACE(@ValuesBatch, NCHAR(29), N''));