/// <summary>
/// Récupère toutes les colonnes de la clé primaire d'une table.
/// Retourne une liste (pour gérer les PK composites).
/// </summary>
private List<string> GetPrimaryKeyColumn(string tableName)
{
    var pkCols = new List<string>();

    string query = @"
        SELECT kcu.COLUMN_NAME
        FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc
        JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu
          ON tc.CONSTRAINT_NAME = kcu.CONSTRAINT_NAME
         AND tc.TABLE_NAME = kcu.TABLE_NAME
        WHERE tc.CONSTRAINT_TYPE = 'PRIMARY KEY'
          AND tc.TABLE_NAME = @table
        ORDER BY kcu.ORDINAL_POSITION";

    DynamicSql sql = new DynamicSql
    {
        Dsn = "PXE1_PXE"
    };
    sql.AddDirectRequest(query, MidwSqlXmlMode.MIDW_SQL_XMLMODE_RAW);
    sql.SetSecureParam("table", tableName, true, 0);
    sql.SetSite(Environment.GetEnvironmentVariable("PFTLSITE"));

    sql.Execute();

    for (int i = 1; i <= sql.ReturnedRows(1, 1); i++)
    {
        pkCols.Add(sql.GetValueUsingColName(i, "COLUMN_NAME", 1, 1));
    }

    return pkCols;
}