private List<ForeignKeyInfo> GetForeignKeyInfo(string tableName)
{
    var fkList = new List<ForeignKeyInfo>();

    var query = $"EXEC sp_GetForeignKeyInfo '{tableName}'";

    DynamicSql sql = new DynamicSql();
    sql.Dsn = "PXE1_PXE";
    sql.AddDirectRequest(query, MidwSqlXmlMode.MIDW_SQL_XMLMODE_RAW);
    sql.SetSite(Environment.GetEnvironmentVariable("PFTLSITE"));
    sql.Execute(30000);

    var rowCount = sql.ReturnedRows(1, 1);
    for (int i = 1; i <= rowCount; i++)
    {
        fkList.Add(new ForeignKeyInfo
        {
            ColumnName = sql.GetValueUsingColName(i, "COLUMN_NAME", 1, 1),
            ReferencedTableName = sql.GetValueUsingColName(i, "REFERENCED_TABLE", 1, 1),
            IsNullable = sql.GetValueUsingColName(i, "IS_NULLABLE", 1, 1) == "1"
        });
    }

    return fkList;
}
