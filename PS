// AVANT
string valuesBatch = BuildValuesBatch(batchRows, insertCols, columnTypes);

// APRÈS (on passe la méta en plus)
var meta = GetColumnsMetaCached(tableName); // tu l’as déjà
string valuesBatch = BuildValuesBatch(batchRows, insertCols, columnTypes, meta);